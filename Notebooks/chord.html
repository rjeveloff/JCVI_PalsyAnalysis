<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>Palsy Chords</title>
    	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Oswald:400,300,700' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>

	<style>
	body {
		  overflow: hidden;
		  margin: 0;
		  font-size: 10px;
		  font-family: 'Raleway', sans-serif;
      text-align: center;
		  /*font-family: Oswald;*/
		  /*font-family: "Helvetica Neue", Helvetica;*/
		}

		</style>
  </head>
  <body>
		<div id="chart"></div>

    <script>
		/*//////////////////////////////////////////////////////////
////////////////// Set up the Data /////////////////////////
//////////////////////////////////////////////////////////*/

var NameProvider = ['Age', 'Gingival Bleeding', 'Caregiver-Reported Quality of Life',
       'Cerebral Palsy Type', 'Comfort and Emotions',
       'Communication and Social Interaction', 'Constipation', 'Gender',
       'Hospitalization and Caregiver-Report Health', 'Medication', 'Movement Ability', 'Personal Care',
       'POSITIONING, TRANSFERRING, AND MOBILITY', 'Cytokines', 'Quality of Life'];

var matrix = [
[0,0.0031786179304180598,0.012082450586947057,0.0007751069543341289,0.0002955368252725349,0.00017423823467778082,0.04011996690568119,0.025121190095750704,0.050335831399324966,8.581278415462083e-05,0.0097420332175247,0.012876801872109876,0.0010821548874584497,0,0.007825631273938071],
[0.0031786179304180598,0,0.16846076322397074,0.013317561980642276,0.4928573621133012,0.32312399779682743,0.4096293843415278,0.0405887678577931,0.3556976868558911,0.11605059730604095,0.3701537966188811,0.24542058643631662,0.2916489121001282,0,0.45317036207734374],
[0.012082450586947057,0.16846076322397074,0,0.0026499577597997427,0.30960005298943777,0.1414159254838392,0.13073995371583416,0.035300753651227174,0.2276222699165447,0.04774316874292297,0.22353570429549396,0.14924264917567587,0.1332430647552014,0,0.37483961943712446],
[0.0007751069543341289,0.013317561980642276,0.0026499577597997427,0,0.011201336098942196,0.016055968021157264,0.002374373064028235,0.00946617897716818,0.032779372701993166,0.007928912930570764,0.12806911649245378,0.08446201898271281,0.06872002075035835,0,0.05528828848881232],
[0.0002955368252725349,0.4928573621133012,0.30960005298943777,0.011201336098942196,0,0.44741236933175443,0.24188238792754274,0.0020451554113705256,0.49272626182171997,0.21854900623393958,0.4800689047707382,0.29887831231406287,0.38170845464675834,0,0.667987029819037],
[0.00017423823467778077,0.32312399779682727,0.1414159254838391,0.016055968021157264,0.4474123693317543,0,0.22135400532754343,0.0007916865108570745,0.27002159078126214,0.4739449374345494,0.5062600519534882,0.3903385628594363,0.4892619207178377,0,0.6782723895589912],
[0.04011996690568119,0.4096293843415279,0.13073995371583416,0.002374373064028235,0.24188238792754274,0.22135400532754343,0,0.03571696448662221,0.1423227153147697,0.08940377190377188,0.19873243919200567,0.24361851214646507,0.17602448053368133,0,0.30147035913533576],
[0.025121190095750704,0.040588767857793105,0.035300753651227174,0.009466178977168182,0.0020451554113705256,0.0007916865108570747,0.03571696448662221,0,0.003971884644700651,0.0006619583007187086,1.9280312217667074e-08,0.0019868052153596363,0.00036207643013031154,0,0.0019716519984195355],
[0.050335831399324966,0.3556976868558911,0.2276222699165447,0.032779372701993166,0.49272626182171997,0.27002159078126214,0.1423227153147697,0.003971884644700651,0,0.17356893948929697,0.31905376630525584,0.12368472742301535,0.16906296640049404,0,0.41391148626884006],
[8.581278415462083e-05,0.11605059730604099,0.04774316874292297,0.007928912930570764,0.21854900623393964,0.4739449374345496,0.08940377190377188,0.0006619583007187086,0.17356893948929705,0,0.3014220027575591,0.21216082081416573,0.2994920691162585,0,0.3556957674262018],
[0.0097420332175247,0.3701537966188811,0.22353570429549396,0.12806911649245378,0.4800689047707382,0.5062600519534882,0.19873243919200567,1.9280312217667074e-08,0.31905376630525584,0.3014220027575591,0,0.6506566837776825,0.7449905384607786,0,0.7964981201201982],
[0.012876801872109876,0.24542058643631662,0.14924264917567587,0.08446201898271281,0.29887831231406287,0.39033856285943647,0.24361851214646507,0.0019868052153596363,0.12368472742301535,0.21216082081416568,0.6506566837776825,0,0.780994288486934,0,0.7642836595043252],
[0.0010821548874584497,0.2916489121001282,0.1332430647552014,0.06872002075035835,0.38170845464675834,0.4892619207178377,0.17602448053368125,0.00036207643013031144,0.16906296640049404,0.2994920691162585,0.7449905384607786,0.780994288486934,0,0,0.8160638302357845],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0.00782563127393807,0.45317036207734374,0.37483961943712435,0.055288288488812294,0.6679870298190368,0.6782723895589912,0.3014703591353356,0.001971651998419535,0.41391148626883995,0.3556957674262015,0.7964981201201979,0.7642836595043249,0.8160638302357844,0,0]
];

/*Sums up to exactly 100*/

var colors = ["#336699","#006699","#009999","#00cc99","#00cc66","#00cc00","#009933","#336600"];

/*Initiate the color scale*/
var fill = d3.scale.ordinal()
    .domain(d3.range(NameProvider.length))
    .range(colors);

/*//////////////////////////////////////////////////////////
/////////////// Initiate Chord Diagram /////////////////////
//////////////////////////////////////////////////////////*/
var margin = {top: 210, right: 210, bottom: 260, left: 200},
    width = 800 - margin.left - margin.right,
    height = 800 - margin.top - margin.bottom,
    innerRadius = Math.min(width, height) * .4,
    outerRadius = innerRadius * 1.075;

/*Initiate the SVG*/
var svg = d3.select("#chart").append("svg:svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
	.append("svg:g")
    .attr("transform", "translate(" + (margin.left + width/2) + "," + (margin.top + height/2) + ")");


var chord = d3.layout.chord()
    .padding(.05)
    .sortSubgroups(d3.descending) /*sort the chords inside an arc from high to low*/
    .sortChords(d3.descending) /*which chord should be shown on top when chords cross. Now the biggest chord is at the bottom*/
	.matrix(matrix);


/*//////////////////////////////////////////////////////////
////////////////// Draw outer Arcs /////////////////////////
//////////////////////////////////////////////////////////*/

var arc = d3.svg.arc()
    .innerRadius(innerRadius)
    .outerRadius(outerRadius);

var g = svg.selectAll("g.group")
	.data(chord.groups)
	.enter().append("svg:g")
	.attr("class", function(d) {return "group " + NameProvider[d.index];});

g.append("svg:path")
	  .attr("class", "arc")
	  .style("stroke", function(d) { return fill(d.index); })
	  .style("fill", function(d) { return fill(d.index); })
	  .attr("d", arc)
	  .style("opacity", 0.3);

/*//////////////////////////////////////////////////////////
////////////////// Initiate Names //////////////////////////
//////////////////////////////////////////////////////////*/

g.append("svg:text")
  .each(function(d) { d.angle = (d.startAngle + d.endAngle) / 2; })
  .attr("dy", ".35em")
  .attr("class", "titles")
  .attr("text-anchor", function(d) { return d.angle > Math.PI ? "end" : null; })
  .attr("transform", function(d) {
		return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")"
		+ "translate(" + (innerRadius + 20) + ")"
		+ (d.angle > Math.PI ? "rotate(180)" : "");
  })
  .attr('opacity', 1)
  .text(function(d,i) { return NameProvider[i]; });

/*//////////////////////////////////////////////////////////
//////////////// Initiate inner chords /////////////////////
//////////////////////////////////////////////////////////*/

var chords = svg.selectAll("path.chord")
	.data(chord.chords)
	.enter().append("svg:path")
	.attr("class", "chord")
	.style("stroke", function(d) { return d3.rgb(fill(d.source.index)).darker(); })
	.style("fill", function(d) { return fill(d.source.index); })
	.attr("d", d3.svg.chord().radius(innerRadius))
	.attr('opacity', .3);

		</script>
   </body>
</html>
